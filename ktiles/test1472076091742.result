"FANCY CANOE"

1   2 1 2   2 2 9 7 8 8 12 13 8 14 24 22 16 18 16 18 17 23 24 46 48 46 47 39 29 32 45 50 47 46 65 61 78 70 67 82 70 77 71 71 77 79 65 86 93 95 95 92 83 83 96 95 91 92 102 90 69 92 121 114 119 120 104 110 115 123 115 102 78 60 32 8                                             
  1 2 1 2 1 2 6 6 5 6 8 10 6 8 18 17 13 13 13 13 14 16 19 30 44 48 43 38 27 19 35 49 46 48 53 53 64 62 70 71 69 76 71 78 80 82 65 67 79 89 77 87 86 79 75 80 78 79 87 84 61 67 96 94 90 91 86 89 91 87 90 81 60 38 24 8                                               
      1         1         1 2 1               1 7 6 7 5 5 2 5 4 10 11 10 11 7 10 21 15 22 20 20 26 17 19 22 26 15 20 26 26 22 23 14 10 24 28 16 18 16 19 12 21 21 23 28 22 16 16 27 24 14 2                                                     
                            1 2 1             3 7 9 12 9 4 2   4 9 15 19 18 13 18 27 25 27 29 23 25 24 19 29 31 33 30 26 34 29 21 20 22 26 25 24 24 20 12 19 29 20 22 20 22 15 20 27 25 9 2                                                     
                                                2             1     1 4   1 1 5 2 5 9 7 7 11 8 1 4   1 4 1 1         1 1 3   2 5                                                                         
                                                  1             1     1 2   1 1 3 1 2 4 3 4 5 1   2   1 1 1 1         1 1     1 3                                                                       
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
____________________________

package org.ag.ktiles;

import org.apache.commons.lang3.tuple.ImmutablePair;

import java.io.File;
import java.io.IOException;
import java.io.PrintWriter;
import java.nio.charset.Charset;
import java.nio.file.Files;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class Main {
    private int xDim = 100;
    private int yDim = 100;
    private int[] currentRhombus = {0, 0};
    private int currentDir = 10;
    private String filename = "test" + System.currentTimeMillis() + ".result";

    public static void main(String[] args) throws InterruptedException, IOException {
        new Main().run();
    }

    private void run() throws InterruptedException, IOException {
        /* Initialize the tile */

        List<Rhombus> koelnerTile = new ArrayList<>();

        for (int i = 0; i < xDim; i++) {
            for (int j = 0; j < yDim; j++) {
                koelnerTile.add(new Rhombus(i, j));
            }
        }



        /* Run the steps */
        for (int i = 0; i < 10000; i++) {
            step(koelnerTile);
//            Thread.sleep(1000);
//            disp(koelnerTile);
        }

        disp(koelnerTile);
    }

    private void disp(List<Rhombus> koelnerTile) throws IOException {
        System.out.println("Saving...");
        PrintWriter writer = new PrintWriter(filename, "UTF-8");
        writer.println("\"NAMEOFRESULT\"");
        writer.println();
        for (int i = 0; i < xDim; i++) {
            for (int j = 0; j < yDim; j++) {
//                System.out.println("On rhombus " + (i * 1000 + j) + ".");
                Rhombus c = koelnerTile.get(getIndex(koelnerTile, new int[]{i, j}));
                if (c.getValue() != 0) {
                    writer.print(c.getValue() + " ");
                } else {
                    writer.print("  ");
                }
            }
            writer.println();
        }
        writer.println("____________________________");
        writer.println();
        List<String> list = Files.readAllLines(new File("C:\\development\\koelner\\ktiles\\src\\org\\ag\\ktiles\\Main.java").toPath(), Charset.defaultCharset());
        for (String line : list) {
            writer.println(line);
        }
        writer.close();
    }

    private List<Rhombus> step(List<Rhombus> koelnerTile) {
        System.out.println("Current coordinates are " + Arrays.toString(currentRhombus) + ".");
        System.out.println("Current direction is " + currentDir + ".");

        int currentIndex = getIndex(koelnerTile, currentRhombus);
        Rhombus current;
        try {
            current = koelnerTile.get(currentIndex);
        } catch (ArrayIndexOutOfBoundsException e) {
            return koelnerTile;
        }
        assert current != null;
        current.increment();

        ImmutablePair<Integer, Integer> neighborCoords = current.getNeighbor(currentDir);
        System.out.println("Neighbor's coordinates are " + neighborCoords + ".");

        // If the neighbor exists, switch to it
        if (neighborCoords != null) {
            currentRhombus[0] = neighborCoords.getLeft();
            currentRhombus[1] = neighborCoords.getRight();
        }

        updateDir();

        if (currentRhombus[0] % 2 == 0) {
            currentRhombus[0] += (int) (Math.floor(Math.sqrt(current.getValue()))) - (int) (Math.floor(Math.sqrt(currentRhombus[1])));
            if (currentRhombus[0] < 0) {
                currentRhombus[0] = 0;
            }
        }

        return koelnerTile;
    }

    private void updateDir() {
        currentDir++;
        currentDir %= 4;
        currentDir += 10;
    }


    private int getIndex(List<Rhombus> koelnerTile, int[] coords) {
        for (Rhombus r : koelnerTile) {
            if (r.getX() == coords[0] && r.getY() == coords[1]) {
                return koelnerTile.indexOf(r);
            }
        }

        return -1;
    }
}
